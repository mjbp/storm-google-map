!function(e,i){"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?module.exports=i():e.StormGoogleMap=i()}(this,function(){"use strict";function e(e){return Object.assign(Object.create(p),{settings:Object.assign({},l,e)}).init()}function i(e,i){var t=document.createElement("script"),o=window.setTimeout(function(){throw new Error("Script "+e+" failed to load in time.")},a.TIMEOUT);t.src=e,t.onload=function(){window.clearTimeout(o),!!i&&i()},document.body.appendChild(t)}function t(){var t=0,o=0,n=function(){if(o++,o===t)return delete window.$__GMAPILoaded__$,e(s)},r=function(e){return i(e,n)};for(var l in s.modules)s.modules.hasOwnProperty(l)&&s.modules[l]&&(t++,r(a[l.toUpperCase()]));if(0===t)return e(s)}function o(e,o,p){var c=document.querySelector(e),d=a.GMAPI+(!p||p.key?"":"&key="+p.key);if(!c)throw new Error("No DOM element supplied to contain map");s=Object.assign({},l,p),n=o,r=c,window.$__GMAPILoaded__$=t,i(d)}var s,n,r,a={GMAPI:"http://maps.googleapis.com/maps/api/js?v=3&callback=$__GMAPILoaded__$",INFOBOX:"https://cdn.rawgit.com/googlemaps/v3-utility-library/a2cdc955fcd20d47db28db645e63f0d2054070c9/1.1.9/src/infobox_packed.js",CLUSTERER:"https://cdn.rawgit.com/googlemaps/v3-utility-library/df501fcbc3e7513d6a94718ab6673de47c202255/1.0.2/src/markerclusterer_compiled.js",SPIDIFIER:"https://jawj.github.io/OverlappingMarkerSpiderfier/bin/oms.min.js",TIMEOUT:6e3},l={key:null,modules:{infobox:!0,clusterer:!0,spidifier:!0},map:{options:{scaleControl:!1,mapTypeControl:!1,overviewMapControl:!0,panControl:!1,rotateControl:!1,streetViewControl:!0,maxZoom:16,zoomControl:!0,styles:[{stylers:[{visibility:"on"},{saturation:-100,hue:"#000000"}]},{featureType:"road.local",stylers:[{visibility:"simplified"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",stylers:[{visibility:"on"}]},{featureType:"transit",stylers:[{visibility:"on"}]}]},markerIcon:"data:image/svg+xml;charset=US-ASCII,%3Csvg%20fill%3D%22%23000000%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%0A%20%20%20%20%3Cpath%20d%3D%22M12%202C8.13%202%205%205.13%205%209c0%205.25%207%2013%207%2013s7-7.75%207-13c0-3.87-3.13-7-7-7zm0%209.5c-1.38%200-2.5-1.12-2.5-2.5s1.12-2.5%202.5-2.5%202.5%201.12%202.5%202.5-1.12%202.5-2.5%202.5z%22/%3E%0A%20%20%20%20%3Cpath%20d%3D%22M0%200h24v24H0z%22%20fill%3D%22none%22/%3E%0A%3C/svg%3E"},spiderifier:{keepSpiderfied:!0,markersWontMove:!0,markersWontHide:!0},clusterer:{maxZoom:12,gridSize:20},infobox:{template:'<div class="infobox"><div class="infobox-inner" id="infobox"><a href="{{url}}"><h1 class="infobox-heading">{{title}}</h1></a></div></div>',closeIcon:"data:image/svg+xml;charset=US-ASCII,%3Csvg%20fill%3D%22%23FFFFFF%22%20height%3D%2218%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2218%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%0A%20%20%20%20%3Cpath%20d%3D%22M19%206.41L17.59%205%2012%2010.59%206.41%205%205%206.41%2010.59%2012%205%2017.59%206.41%2019%2012%2013.41%2017.59%2019%2019%2017.59%2013.41%2012z%22/%3E%0A%20%20%20%20%3Cpath%20d%3D%22M0%200h24v24H0z%22%20fill%3D%22none%22/%3E%0A%3C/svg%3E",urlBase:"/",boxStyle:{width:"250px",opacity:1},pixelOffset:[-115,-10]}},p={init:function(){this.markers=[],this.locations=n,this.element=r,this.createMarkers(),this.map=new google.maps.Map(r,this.settings.map.options),s.modules.spidifier&&this.initSpidifier(),this.placeMarkers(),s.modules.clusterer&&(this.markerCluster=new MarkerClusterer(this.map,this.markers,this.settings.clusterer)),this.setBoundary()},createMarkers:function(){this.boundary=new google.maps.LatLngBounds,this.markers=this.locations.map(function(e){var i=new google.maps.LatLng(e.location.lat,e.location.lng),t={};for(var o in e)e.hasOwnProperty(o)&&"location"!==o&&(t[o]=e[o]);return this.boundary.extend(i),new google.maps.Marker({position:i,clickable:this.settings.modules.infobox,infoBoxData:t,icon:{url:this.settings.map.markerIcon,scaledSize:new google.maps.Size(24,24)},optimized:!1})}.bind(this))},setBoundary:function(){this.markers.length>1?this.map.fitBounds(this.boundary):(this.map.setCenter(this.boundary.getCenter()),this.map.setZoom(this.zoom))},placeMarkers:function(){this.markers.forEach(function(e){e.setMap(this.map),this.settings.modules.spidifier?this.spidifier.addMarker(e):this.settings.modules.infobox&&google.maps.event.addListener(e,"click",this.clickMarker)}.bind(this))},initSpidifier:function(){this.spidifier=new OverlappingMarkerSpiderfier(this.map,this.settings.spiderifier),this.settings.modules.infobox&&this.spidifier.addListener("click",function(e,i){this.clickMarker.call(e)}.bind(this))},clearMarkers:function(){this.markers.length>0&&(this.markers.forEach(function(e){e.setMap(null)}),this.markers.length=0,this.spidifier.clearMarkers())},clickMarker:function(){var e={parseTemplate:function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e=e.split("{{"+t+"}}").join(i[t]));return e}};this.infobox&&this.infobox.close(self.map,this),this.infobox=new InfoBox({content:e.parseTemplate(s.infobox.template,this.infoBoxData),disableAutoPan:!1,zIndex:null,maxWidth:0,boxStyle:s.infobox.boxStyle,pixelOffset:new google.maps.Size(s.infobox.pixelOffset[0],s.infobox.pixelOffset[1]),alignBottom:!0,closeBoxMargin:"4px 4px 4px 4px",isHidden:!1,closeBoxURL:s.infobox.closeIcon,infoBoxClearance:new google.maps.Size(1,1),pane:"floatPane",enableEventPropagation:!1}),this.infobox.open(this.map,this),google.maps.event.addListener(self.map,"click",function(){this.infobox.close(this.map)}.bind(this))}};return{init:o}});